<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="plone">
<body>

<metal:content-core fill-slot="main">
    <metal:content-core define-macro="content-core"
                        tal:define="templateId string:@@mounts-view;
                                    dummy here/autoUpdateData;
                                    mounts context/mountData">
      <h1 tal:content="string:${here/Title} Mounts"/>

      <div metal:use-macro="here/gear_macro/macros/char_header" />
        
      <table class="listing">
        <thead>
          <th colspan="5">Filters</th>
        </thead>
        <tbody>
          <tr>
            <td>
              <input type="checkbox" checked="checked" name="collected" id="collected"/>
              <label for="collected">Collected</label>
            </td>
            <td>
              <input type="checkbox" checked="checked" name="flying" id="flying"/>
              <label for="flying">Flying</label>
            </td>
            <td>
              <input type="checkbox" checked="checked" name="obtainable" id="obtainable"/>
              <label for="obtainable">Obtainable</label>
            </td>
            <td>
              <input type="checkbox" checked="checked" name="alliance" id="alliance"/>
              <label for="alliance">Alliance</label>
            </td>
            <td rowspan="2">
              <input type="checkbox" checked="checked" name="bothmount" id="bothmount"/>
              <label for="bothmount">Both Factions</label>
            </td>
          </tr>
          <tr>
            <td>
              <input type="checkbox" checked="checked" name="notcollected" id="notcollected"/>
              <label for="notcollected">Not Collected</label>
            </td>
            <td>
              <input type="checkbox" checked="checked" name="notflying" id="notflying"/>
              <label for="notflying">Not Flying</label>
            </td>
            <td>
              <input type="checkbox" checked="checked" name="unobtainable" id="unobtainable"/>
              <label for="unobtainable">Not Obtainable</label>
            </td>
            <td>
              <input type="checkbox" checked="checked" name="horde" id="horde"/>
              <label for="horde">Horde</label>
            </td>
          </tr>
        </tbody>
      </table>
      
      <p><span id="mount-counter" tal:content="python:len([m for m in mounts if m['isCollected']])" /> out of <span tal:replace="python:len(mounts)" /> mounts showing</p>

      <table class="tablesorter" id="mount-table">
        <thead>
          <tr>
            <th>Mount Name</th>
            <th>Source</th>
            <th>Collected</th>
            <th>Flying</th>
            <th>Aquatic</th>
            <th>Jumping</th>
            <th>Faction</th>
            <th>Obtainable</th>
          </tr>
        </thead>
        <tbody>
          <tal:mount repeat="mount mounts">
            <tr tal:attributes="class mount/classes">
              <td>
                <a tal:attributes="href string:http://www.wowhead.com/spell=${mount/spellId}">
                  <img tal:condition="mount/icon" tal:attributes="src string:http://us.media.blizzard.com/wow/icons/18/${mount/icon}.jpg" />
                  <span tal:omit-tag="" tal:content="mount/name"/>
                </a>                  
              </td>
              <td tal:content="mount/location" />
              <td>
                <span tal:condition="mount/isCollected">&#10004;</span>
              </td>
              <td>
                <span tal:condition="mount/isFlying">&#10004;</span>
              </td>
              <td>
                <span tal:condition="mount/isAquatic">&#10004;</span>
              </td>
              <td>
                <span tal:condition="mount/isJumping">&#10004;</span>
              </td>
              <td tal:content="python:mount['faction'] == 'A' and 'Alliance' or mount['faction'] == 'H' and 'Horde' or 'Both'" />
              <td tal:content="mount/obtainable"/>
            </tr>
          </tal:mount>
        </tbody>
      </table>
      
      <script type="text/javascript">
        $(document).ready(function() {
          $('#collected').click(function() {$('.obtainedMount').toggleClass('obtainedMountHidden');$('#mount-counter').html($('#mount-table tr:visible').length-1);});
          $('#notcollected').click(function() {$('.unobtainedMount').toggleClass('unobtainedMountHidden');$('#mount-counter').html($('#mount-table tr:visible').length-1);});
          $('#flying').click(function() {$('.isFlying').toggleClass('obtainedMountHidden');$('#mount-counter').html($('#mount-table tr:visible').length-1);});
          $('#notflying').click(function() {$('.notisFlying').toggleClass('notisFlyingHidden');$('#mount-counter').html($('#mount-table tr:visible').length-1);});
          $('#obtainable').click(function() {$('.obtainableMount').toggleClass('obtainableMountHidden');$('#mount-counter').html($('#mount-table tr:visible').length-1);});
          $('#unobtainable').click(function() {$('.unobtainableMount').toggleClass('unobtainableMountHidden');$('#mount-counter').html($('#mount-table tr:visible').length-1);});
          $('#alliance').click(function() {$('.allianceMount').toggleClass('allianceMountHidden');$('#mount-counter').html($('#mount-table tr:visible').length-1);});
          $('#horde').click(function() {$('.hordeMount').toggleClass('hordeMountHidden');$('#mount-counter').html($('#mount-table tr:visible').length-1);});
          $('#bothmount').click(function() {$('.bothMount').toggleClass('bothMountHidden');$('#mount-counter').html($('#mount-table tr:visible').length-1);});
          $('#mount-table tr:odd').addClass("odd");
          $('#mount-table').tablesorter().bind("sortEnd", function(){
              $('#mount-table tr:odd').addClass("odd");
              $('#mount-table tr:even').removeClass("odd");
          });
        });

    </metal:content-core>
</metal:content-core>

</body>
</html>